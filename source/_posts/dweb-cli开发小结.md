---
title: dweb-cli å¼€å‘å°ç»“
date: 2023-12-20 16:21:07
tags: [JavaScript ,NodeJS, å¼€å‘å°ç»“]
categories: [å‰ç«¯]
---
æ¯æ¬¡éƒ½æ˜¯ä»è€é¡¹ç›®ä¸­ `Ctrl+C` & `Ctrl+V` æ‹·è´ä¸€ä»½æ–‡ä»¶ç›®å½•å’Œç¼–è¯‘è„šæœ¬ï¼Œç„¶ååˆ åˆ æ”¹æ”¹å°±å¯ä»¥è·‘æ–°é¡¹ç›®äº†ã€‚å¤§å¤šé¡¹ç›®çš„ç¼–è¯‘æ¨¡å—å…¶å®éƒ½å¤§åŒå°å¼‚ã€‚äºæ˜¯åœ¨ 2022 å¹´å¹´ä¸­çš„æ—¶å€™å†™äº†ä¸€ä¸ªå‰ç«¯è„šæ‰‹æ¶ï¼Œä¸»è¦åŠŸèƒ½æ˜¯ã€ç”Ÿæˆé¡¹ç›®æ¨¡æ¿ã€‘å¹¶ã€ç»Ÿä¸€å†…éƒ¨æ‰“åŒ…å·¥å…·ã€‘ã€‚
ä»Šå¹´ä¸»è¦æ˜¯æŒ‰éœ€ç»´æŠ¤å’Œæ›´æ–°ï¼Œä» v1 å‡çº§è‡³ v2 ï¼Œå¹¶å‰”é™¤ç¬¬äºŒä¸ªåŠŸèƒ½ğŸ˜²ã€‚

<!-- more -->

### å‰æœŸå‡†å¤‡
- ç¡®å®šé¡¹ç›®åç§°ï¼šå¥½è®°ã€ä¸€ç›®äº†ç„¶
- ç¡®å®šä¸»è¦åŠŸèƒ½
- ç¡®å®šä¾èµ–ç‰ˆæœ¬ï¼šè°ƒç ”ç»„å†…é¡¹ç›®ã€æ„å»ºå·¥å…·çš„ webpack å’Œ React ç‰ˆæœ¬ 
- ç¡®å®šå‘½ä»¤è¡ŒåŸºç¡€äº¤äº’åŠŸèƒ½ï¼šå‚è€ƒ vue-cli å’Œ create-react-app ä¸¤ä¸ªè„šæ‰‹æ¶ 
- ç¡®å®šè„šæ‰‹æ¶é¡¹ç›®ç»“æ„
- ç¡®å®šç”Ÿæˆçš„æ¨¡æ¿é¡¹ç›®ç»“æ„ï¼šè°ƒç ”ç»„å†…é¡¹ç›®

### é¡¹ç›®æ­å»º
#### é¡¹ç›®åç§°
è„šæ‰‹æ¶åå­—å®šä¸º dweb-cli ï¼Œè¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªç”¨äº douban web é¡¹ç›®å¼€å‘çš„å·¥å…·ã€‚
#### ä¸»è¦åŠŸèƒ½
- ç”Ÿæˆé€šç”¨é¡¹ç›®æ¨¡æ¿
- é›†æˆç¼–è¯‘è„šæœ¬ï¼šè®©ç”¨æˆ·å¯ä»¥é€šè¿‡ dweb-cli ç›´æ¥ç¼–è¯‘è„šæ‰‹æ¶ç”Ÿæˆçš„é¡¹ç›®ã€è€Œæ— éœ€å†æ‰‹åŠ¨é…ç½®ã€‚
#### ä¾èµ–ç‰ˆæœ¬
`Webpack 5`ã€`React 17.0.2`
#### å‘½ä»¤è¡Œäº¤äº’

__1. é¡¹ç›®åˆ›å»º__
```sh
dweb create <projectName>
```
è‡ªå®šä¹‰é€‰é¡¹:
- æ˜¯å¦éœ€è¦ react router
- æ˜¯å¦éœ€è¦ reset.css
- UI é€‚é…æ¨¡å¼ï¼šnone | flex2rem | viewport
- æ˜¯å¦åœ¨åˆ›å»ºå®Œæˆåè‡ªåŠ¨æ‰§è¡Œ `npm install`

__2. é¡¹ç›®ç¼–è¯‘__
```sh
dweb run serve # æœ¬åœ°å¯ç”¨ webpack-dev-server å¼€å‘
dweb run dev # å¼€å‘æ¨¡å¼
dweb run build # ç”Ÿäº§æ¨¡å¼
```
å¯é€‰å‚æ•°ï¼š
- `-cï¼Œ --config` æŒ‡å®š webpack é…ç½®è·¯å¾„
- `-d, --deploy-config` æŒ‡å®šç¼–è¯‘å®Œæˆåçš„å›è°ƒå‡½æ•°ï¼ˆæ–‡ä»¶ï¼‰è·¯å¾„
- `-e, --entry` æŒ‡å®šè¦ç¼–è¯‘çš„å…¥å£åï¼Œé»˜è®¤ç¼–è¯‘å…¨éƒ¨å…¥å£
- `--dev-server-options` æŒ‡å®š webpack-dev-server é…ç½®è·¯å¾„
- `--free-config` å®Œå…¨ä½¿ç”¨çš„ `--config` ä¸­æŒ‡å®šçš„é…ç½®ï¼Œä¸ä½¿ç”¨ cli è‡ªå¸¦çš„é»˜è®¤é…ç½®

__3. å…¶ä»–å‘½ä»¤__
```sh
dweb clean # æ¸…ç† /dist æ–‡ä»¶å¤¹
dweb export <configType> # å¯¼å‡º cli ä¸­çš„æŸé¡¹é…ç½®åˆ°å½“å‰ç›®å½•
```
#### è„šæ‰‹æ¶ç›®å½•ç»“æ„
```sh
 â”œâ”€â”€ .github/workflows # github ci é…ç½®æ–‡ä»¶
 â”œâ”€â”€ .husky # ä»£ç æäº¤ç›¸å…³çš„é’©å­é…ç½®ï¼ˆeslintï¼‰
 â”œâ”€â”€ bin # npm æ³¨å†Œçš„å‘½ä»¤
 â”œâ”€â”€ build/utils # æ„å»ºå·¥å…·
 â”œâ”€â”€ lib # å‘½ä»¤ç›¸å…³çš„å®ç°
 â”œâ”€â”€ template # æ¨¡æ¿é¡¹ç›®
```
   
#### æ¨¡æ¿é¡¹ç›®ç›®å½•ç»“æ„
```
â”œâ”€â”€ README.md
â”œâ”€â”€ deploy.config.js
â”œâ”€â”€ package.json
â”œâ”€â”€ src
â”‚   â”œâ”€â”€ common
â”‚   â”‚   â”œâ”€â”€ assets
â”‚   â”‚   â”œâ”€â”€ components
â”‚   â”‚   â”‚   â””â”€â”€ App
â”‚   â”‚   â”‚       â”œâ”€â”€ index.tsx
â”‚   â”‚   â”‚       â””â”€â”€ style.scss
â”‚   â”‚   â”œâ”€â”€ const
â”‚   â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”‚   â”œâ”€â”€ types
â”‚   â”‚   â”‚   â””â”€â”€ index.d.ts
â”‚   â”‚   â””â”€â”€ utils
â”‚   â”‚       â””â”€â”€ axios-instance.ts
â”‚   â””â”€â”€ pages
â”‚       â”œâ”€â”€ test
â”‚       â”‚   â”œâ”€â”€ index.tsx
â”‚       â”‚   â””â”€â”€ style.scss
â”‚       â””â”€â”€ test1
â”‚           â”œâ”€â”€ index.tsx
â”‚           â””â”€â”€ style.scss
â”œâ”€â”€ tsconfig.json
â”œâ”€â”€ webpack.config.js
â””â”€â”€ yarn.lock
```
   
### v1 å‡çº§è‡³ v2
v1 è¯•ç”¨åŠå¹´åï¼Œå‘ç°å›¢é˜Ÿä½¿ç”¨ä¹ æƒ¯æ›´æ³¨é‡çµæ´»æ€§ã€‚å¦‚æœå°†ç¼–è¯‘å…¨éƒ¨é›†æˆåœ¨ dweb é‡Œï¼Œå¾ˆå¤šå°é¡¹ç›®å®šåˆ¶åŒ–é…ç½®åå€’å¤æ‚äº†ä¸€äº›ã€‚ä¸”å¤§å®¶å¯¹äº dweb å†…å·²é›†æˆçš„ loader å’Œç¼–è¯‘é…ç½®å®é™…ä¸Šå¹¶ä¸çŸ¥æ™“ï¼ˆå¾ˆå°‘ä¼šç‚¹è¿›é¡¹ç›®æŸ¥çœ‹ï¼‰ï¼Œæ›´å¸Œæœ›èƒ½ __ç›´æ¥__ çœ‹åˆ°å½“å‰é¡¹ç›®çš„â€œç¼–è¯‘é…ç½®â€ã€‚
æ‰€ä»¥ v2 ç‰ˆæœ¬çš„ dweb ä¸å†é›†æˆç¼–è¯‘å·¥ä½œï¼Œè€Œæ˜¯å°†åŸºç¡€çš„ç¼–è¯‘é…ç½®æ”¾åˆ°é¡¹ç›®æ¨¡æ¿ä¸­ï¼Œåˆ›å»ºæ–°é¡¹ç›®æ—¶ä¼šè‡ªåŠ¨åœ¨æ–°é¡¹ç›®ä¸­ç”Ÿæˆä¸€å¥—é»˜è®¤çš„ç¼–è¯‘è„šæœ¬ã€‚
#### å…¶ä»–æ›´æ–°
- ä½¿ç”¨ `swc-loader` æ›¿æ¢ `babel-loader` ä»¥å‡å°‘ç¼–è¯‘è€—æ—¶
- æ”¯æŒç¬¬ä¸‰æ–¹æ’ä»¶ css module å•ç‹¬ç¼–è¯‘
- å¢åŠ  CIã€Log åŸ‹ç‚¹ä¸ŠæŠ¥ã€ç™»å½•çŠ¶æ€è·å–ç­‰åŸºç¡€é…ç½®
- å¢åŠ  é¡µé¢å¯¼èˆªå¤´ã€ErrorBoundary ç­‰å¸¸ç”¨ç»„ä»¶

### å¼€å‘è¿‡ç¨‹ä¸­ç”¨åˆ°çš„å·¥å…·
- [commander](https://github.com/tj/commander.js)ï¼šå‘½ä»¤è¡Œå‚æ•°æ¥æ”¶å·¥å…·
- [chalk](https://github.com/chalk/chalk)ï¼šå‘½ä»¤è¡Œç¾åŒ–å·¥å…·ï¼Œç”¨äºè°ƒæ•´è¾“å‡ºä¿¡æ¯å„å­—ä½“é¢œè‰²
- [inquirer](https://github.com/SBoudrias/Inquirer.js)ï¼šå‘½ä»¤è¡Œäº¤äº’å·¥å…·ï¼Œç”¨äºè·å–ç”¨æˆ·äº¤äº’ç»“æœ å¹¶ç”¨ promise è¿”å›å€¼
- [ora](https://github.com/sindresorhus/ora)ï¼šå‘½ä»¤è¡Œè¿›åº¦æ¡ç¾åŒ–å·¥å…·
- [handlebars](https://github.com/handlebars-lang/handlebars.js)ï¼šæ¨¡æ¿æ¸²æŸ“å·¥å…·


